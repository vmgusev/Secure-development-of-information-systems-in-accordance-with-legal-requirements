# Практическая работа №10 - Реализация алгоритма Эль-Гамаля

## Описание

Данная практическая работа посвящена реализации алгоритма Эль-Гамаля на языке Python. Работа выполнена для варианта №7.

## Задача

Реализовать на языке Python программу для:
1. Шифрования и расшифрования коротких текстовых сообщений с помощью алгоритма Эль-Гамаля
2. Получения цифровой подписи для текстового сообщения на основе модификации алгоритма Эль-Гамаля

## Требования

1. **Параметры p, n, α задаются пользователем**
2. **Проверка простоты числа p** (перебор, тест Миллера-Рабина, малая теорема Ферма)
3. **Проверка допустимости параметров n, α** в связи со значением p
4. **Число k подбирается программой**
5. **Персональное сообщение** - собственная фамилия
6. **Преобразование текста в числа** - собственное обратимое преобразование
7. **Все функции реализованы самостоятельно** (без использования специализированных библиотек)

## Файлы

### Основные программы

- **`elgamal_implementation.py`** - Основная реализация алгоритма Эль-Гамаля
  - Класс `ElGamal` с полной реализацией алгоритма
  - Методы проверки простоты чисел
  - Методы шифрования и расшифрования
  - Методы создания и проверки цифровой подписи
  - Преобразование текста в числа и обратно

- **`elgamal_demo.py`** - Демонстрация работы алгоритма
  - Примеры работы с разными параметрами
  - Демонстрация шифрования и цифровой подписи

- **`elgamal_tests.py`** - Тесты для проверки корректности
  - Unit-тесты для всех основных функций
  - Проверка корректности шифрования и расшифрования
  - Проверка работы цифровой подписи

### Документация

- **`README.md`** - Данный файл с описанием
- **`Практическая_работа_10_Отчет.md`** - Подробный отчет о выполненной работе

## Запуск программ

```bash
# Основная программа с интерактивным вводом
python3 elgamal_implementation.py

# Демонстрация работы
python3 elgamal_demo.py

# Запуск тестов
python3 elgamal_tests.py
```

## Алгоритм работы

### 1. Шифрование Эль-Гамаля

1. **Генерация ключей:**
   - Выбирается простое число p
   - Выбирается порядок группы n (делитель p-1)
   - Выбирается генератор α группы
   - Генерируется закрытый ключ x (1 ≤ x < n)
   - Вычисляется открытый ключ y = α^x mod p

2. **Шифрование:**
   - Сообщение преобразуется в числа
   - Для каждого числа m выбирается случайное k
   - Вычисляется c1 = α^k mod p
   - Вычисляется c2 = m * y^k mod p
   - Пара (c1, c2) - зашифрованное сообщение

3. **Расшифрование:**
   - Вычисляется m = c2 * (c1^(p-1-x)) mod p

### 2. Цифровая подпись Эль-Гамаля

1. **Создание подписи:**
   - Вычисляется хеш сообщения h
   - Выбирается случайное k (взаимно простое с n)
   - Вычисляется r = α^k mod p
   - Вычисляется s = (h - x*r) * k^(-1) mod n
   - Пара (r, s) - цифровая подпись

2. **Проверка подписи:**
   - Вычисляется хеш сообщения h
   - Вычисляется v1 = α^h mod p
   - Вычисляется v2 = y^r * r^s mod p
   - Подпись валидна, если v1 = v2

## Преобразование текста в числа
- Используется собственное обратимое преобразование:
  - A=1, B=2, ..., Z=26, пробел=27
  - Обратное: 1→A, 2→B, ..., 26→Z, 27→пробел

## Примеры работы

### Пример 1: Маленькие числа
- Параметры: p=23, n=11, α=2
- Сообщение: "HELLO"
- Результат: успешно шифруется и полностью корректно расшифровывается

### Пример 2: Другие параметры
- Параметры: p=23, n=11, α=3 (тоже генератор порядка 11)
- Сообщение: "CRYPTO"
- Результат: для некоторых k возможны отклонения; рекомендуется использовать α=2 или 6

### Пример 3: Персональный вариант
- Параметры: p=23, n=11, α=6
- Сообщение: "STUDENT"
- Результат: успешно шифруется и полностью корректно расшифровывается

## Результаты тестирования
- Всего тестов: 11
- Успешно: 11
- Неудачно: 0
- Покрытие: проверка простоты (перебор, Миллера–Рабина, Ферма), проверка параметров, шифрование/расшифрование, модульный обратный, подпись и верификация.

## Требования

- Python 3.6+
- Стандартные библиотеки Python (random, math, typing)

## Автор

Гусев В.М. КВМО-11-24  
Дата: 2025
