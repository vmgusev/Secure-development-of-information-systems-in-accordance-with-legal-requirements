# Практическая работа №9 - Реализация алгоритма RSA

## Описание

Данная практическая работа посвящена реализации алгоритма RSA для шифрования и расшифрования текстовых сообщений на языке Python. Работа выполнена для варианта №7.

## Задача

Реализовать программу для шифрования и расшифрования коротких текстовых сообщений с помощью алгоритма RSA, выполнив все требования:

1. Простые числа p и q задаются пользователем
2. Проверка простоты чисел различными методами
3. Число e вводится пользователем или подбирается программой
4. Число d вычисляется алгоритмом Евклида
5. Шифрование собственной фамилии
6. Обратимое преобразование текста в числа
7. Эксперимент с закрытым ключом
8. Эксперимент с открытым ключом
9. Все функции реализованы самостоятельно

## Файлы

### Основные программы

1. **`rsa_implementation.py`** - Основная программа
   - Интерактивный ввод параметров
   - Полная демонстрация всех экспериментов
   - Подробный вывод всех этапов

2. **`rsa_demo.py`** - Демонстрационная программа
   - Различные демонстрации функций
   - Интерактивный режим
   - Примеры использования

3. **`rsa_tests.py`** - Программа тестирования
   - Комплексное тестирование всех функций
   - Автоматическая проверка корректности
   - Статистика результатов

### Документация

- **`Практическая_работа_9_Отчет.md`** - Подробный отчет о выполненной работе
- **`README.md`** - Данный файл с описанием

## Запуск программ

```bash
# Основная программа
python3 rsa_implementation.py

# Демонстрационная программа
python3 rsa_demo.py

# Тестирование
python3 rsa_tests.py
```

## Реализованные алгоритмы

### 1. Проверка простоты чисел
- **Простой тест**: перебор делителей от 2 до √n
- **Тест Ферма**: малая теорема Ферма
- **Тест Миллера-Рабина**: вероятностный тест простоты

### 2. Алгоритм Евклида
- **Обычный НОД**: нахождение наибольшего общего делителя
- **Расширенный алгоритм**: нахождение коэффициентов Безу

### 3. Быстрое возведение в степень
- Алгоритм быстрого возведения в степень по модулю
- Оптимизирован для работы с большими числами

### 4. Генерация ключей RSA
- Проверка простоты p и q
- Вычисление n = p * q
- Вычисление φ(n) = (p-1)(q-1)
- Поиск e (открытой экспоненты)
- Вычисление d (закрытой экспоненты)

### 5. Шифрование и расшифрование
- Преобразование текста в числа
- Шифрование по формуле c = m^e mod n
- Расшифрование по формуле m = c^d mod n
- Обработка больших чисел

## Результаты экспериментов

### Эксперимент 1: Шифрование открытым ключом, расшифрование закрытым
- ✅ Успешно

### Эксперимент 2: Шифрование закрытым ключом, расшифрование открытым
- ✅ Успешно

### Эксперимент 3: Попытка расшифровать открытым ключом то, что зашифровано открытым ключом
- ✅ Не удается (как и ожидалось)

## Тестирование

- **114 тестов** покрывают все функции
- **98.2% успеха** (112 тестов пройдено, 2 провалено)
- Проваленные тесты связаны с автоматическим исправлением ошибок пользователя

## Особенности реализации

### 1. Обработка больших чисел
- Алгоритм разбиения больших чисел на части
- Маркеры для разделения частей
- Корректная сборка чисел при расшифровке

### 2. Преобразование текста
- Каждый символ кодируется как (ASCII + 1000)
- Обеспечивает обратимость и избегает проблем с нулями
- Поддерживает любые символы ASCII

### 3. Автоматический подбор e
- Стандартные значения: 3, 5, 17, 257, 65537
- Случайный поиск при неудаче
- Проверка условия НОД(e, φ(n)) = 1

### 4. Комплексная проверка простоты
- Три различных теста
- Число считается простым только при прохождении всех тестов
- Высокая надежность

## Пример использования

```python
from rsa_implementation import RSAImplementation

# Создаем экземпляр RSA
rsa = RSAImplementation()

# Генерируем ключи
rsa.generate_keys(11, 13)

# Шифруем сообщение
encrypted = rsa.encrypt("Hello", rsa.public_key)

# Расшифровываем сообщение
decrypted = rsa.decrypt(encrypted, rsa.private_key)

print(f"Исходное: Hello")
print(f"Зашифрованное: {encrypted}")
print(f"Расшифрованное: {decrypted}")
```

## Требования

- Python 3.6+
- Стандартные библиотеки Python (math, random, typing)

## Автор

Гусев В.М. КВМО-11-24  
Дата: 2025
